@startuml

actor Пользователь
actor Библиотекарь
participant Система

Пользователь -> Библиотекарь : Запрос на получение книги requestBookIssue()
Библиотекарь -> Система : Поиск книги searchBook()

alt Книга доступна
    Система --> Библиотекарь : Книга найдена
    Библиотекарь -> Система : Проверка задолженностей checkUserDebts(userID)
    alt Нет задолженностей
        Система --> Библиотекарь : Задолженностей нет
        Библиотекарь -> Система : Обновить статус книги на "выдана" updateBookStatus("выдана")
        Библиотекарь -> Система : Зафиксировать информацию о пользователе, дате выдачи и сроке возврата fixIssue(userID,date_issue,return_period)
        Библиотекарь -> Пользователь : Передать книгу giveBook(book_id)
        Библиотекарь --> Система : Получение книги завершено
    else Есть задолженности
        Система --> Библиотекарь : Обнаружены задолженности
	Система -> Система : Заблокировать выдачу blockIssue(userID)
        Библиотекарь -> Пользователь : Сообщить о задолженностях reportDebt()
        Библиотекарь -> Пользователь : Предложить погасить задолженность offerDebtRepay()
    end
else Книга недоступна
    Система --> Библиотекарь : Книга недоступна
    Библиотекарь -> Пользователь : Сообщить о недоступности книги reportBookUnavailable()
    Библиотекарь -> Пользователь : Предложить альтернативы offerAlternatives()
    Пользователь -> Библиотекарь : Выбрать альтернативу chooseAlternative(alternative_number)
end

@enduml
